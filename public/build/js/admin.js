function e(){t(),o(),r(),n(),gestionarUsuarios()}function t(){const e=document.querySelector("#fecha");if(e){e.addEventListener("input",(function(e){const t=e.target.value;window.location="?fecha="+t}));const t=document.querySelector('a[href="/admin"]');t&&t.addEventListener("click",(function(t){t.preventDefault(),e.value="",window.location="/admin"}))}}function o(){document.querySelectorAll(".estado-cita").forEach(e=>{e.addEventListener("change",(function(e){const t=e.target.dataset.citaId,o=e.target.value,r=e.target.closest(".bg-white").querySelector(".estado-badge");Swal.fire({title:"Actualizando...",text:"Por favor espere",allowOutsideClick:!1,showConfirmButton:!1,willOpen:()=>{Swal.showLoading()}});const n=new FormData;n.append("id",t),n.append("estado",o);try{fetch("/api/citas/estado",{method:"POST",body:n}).then(e=>e.json()).then(e=>{if("exito"===e.tipo){const e={pendiente:"bg-yellow-100 text-yellow-800",completada:"bg-green-100 text-green-800",cancelada:"bg-red-100 text-red-800"};r.className="estado-badge px-3 py-1 rounded-full text-sm font-medium",r.classList.add(...e[o].split(" ")),r.textContent=o.charAt(0).toUpperCase()+o.slice(1),Swal.fire({icon:"success",title:"Estado Actualizado",text:"El estado de la cita se actualizó correctamente",showConfirmButton:!1,timer:1500})}})}catch(e){Swal.fire({icon:"error",title:"Error",text:"Hubo un error al actualizar el estado"})}}))})}function r(){const e=document.querySelectorAll(".tab-btn"),t=document.querySelectorAll(".tab-content");e.forEach(o=>{o.addEventListener("click",(function(){e.forEach(e=>{e.classList.remove("border-blue-500","text-blue-600"),e.classList.add("border-transparent","text-gray-500")}),t.forEach(e=>{e.classList.add("hidden")}),this.classList.remove("border-transparent","text-gray-500"),this.classList.add("border-blue-500","text-blue-600");const o=this.dataset.tab,r=document.querySelector(`#${o}-tab`);r&&r.classList.remove("hidden")}))})}function n(){const e=document.querySelector("#nuevo-servicio");e&&e.addEventListener("click",i);document.querySelectorAll(".editar-servicio").forEach(e=>{e.addEventListener("click",(function(){c(this.dataset.id)}))});document.querySelectorAll(".eliminar-servicio").forEach(e=>{e.addEventListener("click",(function(){s(this.dataset.id)}))})}function i(e={}){Swal.fire({title:e.id?"Editar Servicio":"Nuevo Servicio",html:`\n            <form id="formulario-servicio" class="space-y-4">\n                <input type="hidden" name="id" value="${e.id||""}">\n                <div>\n                    <label class="block text-sm font-medium text-gray-700">Nombre del Servicio</label>\n                    <input type="text" name="nombre_servicio" \n                           class="mt-1 block w-full rounded-md border-gray-300" \n                           value="${e.nombre_servicio||""}" \n                           required \n                           minlength="3"\n                           \n                           title="Solo se permiten letras y espacios">\n                </div>\n                <div>\n                    <label class="block text-sm font-medium text-gray-700">Precio</label>\n                    <input type="number" name="precio" \n                           class="mt-1 block w-full rounded-md border-gray-300" \n                           value="${e.precio||""}" \n                           required \n                           min="3000"\n                           max="100000"\n                           step="1">\n                </div>\n                <div>\n                    <label class="block text-sm font-medium text-gray-700">Tiempo Estimado (minutos)</label>\n                    <input type="number" name="tiempo_estimado" \n                           class="mt-1 block w-full rounded-md border-gray-300" \n                           value="${e.tiempo_estimado||""}" \n                           required \n                           min="1"\n                           step="1">\n                </div>\n            </form>\n        `,showCancelButton:!0,confirmButtonText:e.id?"Actualizar":"Crear",cancelButtonText:"Cancelar",preConfirm:()=>{const t=document.getElementById("formulario-servicio");if(!t.checkValidity())return t.reportValidity(),!1;return a(new FormData(t),e.id)}})}async function a(e,t){try{const o=t?"/api/servicios/actualizar":"/api/servicios/crear",r=await fetch(o,{method:"POST",body:e}),n=await r.json();"exito"===n.tipo?(Swal.fire("¡Éxito!",n.mensaje,"success"),setTimeout(()=>{window.location.reload()},1500)):Swal.fire("Error",n.mensaje,"error")}catch(e){console.error(e),Swal.fire("Error","Hubo un error al procesar la solicitud","error")}}async function c(e){try{const t=await fetch("/api/servicios/"+e);i(await t.json())}catch(e){console.error(e),Swal.fire("Error","No se pudo cargar el servicio","error")}}function s(e){Swal.fire({title:"¿Estás seguro?",text:"Esta acción no se puede revertir",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Sí, eliminar",cancelButtonText:"Cancelar"}).then(t=>{t.isConfirmed&&l(e)})}async function l(e){try{const t=new FormData;t.append("id",e);const o=await fetch("/api/servicios/eliminar",{method:"POST",body:t}),r=await o.json();"exito"===r.tipo?(Swal.fire("¡Eliminado!",r.mensaje,"success"),setTimeout(()=>{window.location.reload()},1500)):Swal.fire("Error",r.mensaje,"error")}catch(e){console.error(e),Swal.fire("Error","Hubo un error al eliminar el servicio","error")}}document.addEventListener("DOMContentLoaded",(function(){e()}));
//# sourceMappingURL=admin.js.map
