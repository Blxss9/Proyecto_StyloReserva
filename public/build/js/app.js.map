{"version":3,"sources":["app.js"],"names":["paso","pasoInicial","pasoFinal","cita","id","nombre","fecha","hora","servicios","iniciarApp","mostrarSeccion","tabs","botonesPaginador","paginaSiguiente","paginaAnterior","consultarAPI","idCliente","nombreCliente","seleccionarFecha","seleccionarHora","mostrarResumen","async","url","respuesta","fetch","resultado","json","error","console","mostrarAlerta","mostrarServicios","contenedorServicios","document","querySelector","innerHTML","log","forEach","servicio","nombre_servicio","precio","servicioDiv","createElement","classList","add","dataset","idServicio","onclick","seleccionarServicio","appendChild","btnSiguiente","addEventListener","validarResumen","validarFecha","validarServicios","btnAnterior","disabled","remove","textContent","seccionAnterior","pasoSelector","seccion","tabAnterior","tab","progreso","style","width","mensaje","tipo","Swal","alert","fire","icon","title","text","querySelectorAll","boton","e","parseInt","target","length","value","Object","values","includes","divServicio","some","agregado","filter","dia","Date","getUTCDay","split","resumen","firstChild","removeChild","headingServicios","contenedorServicio","textoServicio","precioServicio","headingCita","fechaFormateada","toLocaleDateString","weekday","year","month","day","fechaCita","horaCita"],"mappings":"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","file":"app.js","sourcesContent":["let paso = 1;\r\nconst pasoInicial = 1;\r\nconst pasoFinal = 4;\r\n\r\nconst cita = {\r\n    id: '',\r\n    nombre: '',\r\n    fecha: '',\r\n    hora: '',\r\n    servicios: []\r\n}\r\n\r\ndocument.addEventListener('DOMContentLoaded', function() {\r\n    iniciarApp();\r\n});\r\n\r\nfunction iniciarApp() {\r\n    mostrarSeccion(); // Muestra y oculta las secciones\r\n    tabs(); // Cambia la sección cuando se presionen los tabs\r\n    botonesPaginador(); // Agrega o quita los botones del paginador\r\n    paginaSiguiente();\r\n    paginaAnterior();\r\n    \r\n    consultarAPI(); // Consulta la API en el backend de PHP\r\n    \r\n    idCliente(); // Añade el id del cliente al objeto de cita\r\n    nombreCliente(); // Añade el nombre del cliente al objeto de cita\r\n    seleccionarFecha(); // Añade la fecha de la cita en el objeto\r\n    seleccionarHora(); // Añade la hora de la cita en el objeto\r\n    \r\n    mostrarResumen(); // Muestra el resumen de la cita\r\n}\r\n\r\nasync function consultarAPI() {\r\n    try {\r\n        const url = '/api/servicios';\r\n        const respuesta = await fetch(url);\r\n        const resultado = await respuesta.json();\r\n        \r\n        if(!resultado.error) {\r\n            mostrarServicios(resultado);\r\n        } else {\r\n            console.error(resultado.error);\r\n            mostrarAlerta('Error al cargar los servicios', 'error');\r\n        }\r\n        \r\n    } catch (error) {\r\n        console.error(error);\r\n        mostrarAlerta('Error al cargar los servicios', 'error');\r\n    }\r\n}\r\n\r\nfunction mostrarServicios(servicios) {\r\n    const contenedorServicios = document.querySelector('#servicios');\r\n    \r\n    if(!contenedorServicios) {\r\n        console.error('El contenedor de servicios no existe');\r\n        return;\r\n    }\r\n    \r\n    // Limpiar el HTML previo\r\n    contenedorServicios.innerHTML = '';\r\n    \r\n    console.log('Servicios recibidos:', servicios); // Debug\r\n    \r\n    servicios.forEach(servicio => {\r\n        const { id, nombre_servicio, precio } = servicio;\r\n\r\n        const servicioDiv = document.createElement('DIV');\r\n        servicioDiv.classList.add('servicio');\r\n        servicioDiv.dataset.idServicio = id;\r\n\r\n        servicioDiv.innerHTML = `\r\n            <p class=\"nombre-servicio\">${nombre_servicio}</p>\r\n            <p class=\"precio-servicio\">$${precio}</p>\r\n        `;\r\n\r\n        servicioDiv.onclick = () => seleccionarServicio(servicio);\r\n\r\n        contenedorServicios.appendChild(servicioDiv);\r\n    });\r\n}\r\n\r\nfunction paginaSiguiente() {\r\n    const btnSiguiente = document.querySelector('#siguiente');\r\n    \r\n    if(!btnSiguiente) return;\r\n    \r\n    btnSiguiente.addEventListener('click', () => {\r\n        if(paso >= pasoFinal) return;\r\n        \r\n        let resultado = true;\r\n        \r\n        if(paso === 3) {\r\n            resultado = validarResumen();\r\n        } else if(paso === 2) {\r\n            resultado = validarFecha();\r\n        } else if(paso === 1) {\r\n            resultado = validarServicios();\r\n        }\r\n        \r\n        if(resultado) {\r\n            paso++;\r\n            mostrarSeccion();\r\n            botonesPaginador();\r\n        }\r\n    });\r\n}\r\n\r\nfunction paginaAnterior() {\r\n    const btnAnterior = document.querySelector('#anterior');\r\n    \r\n    if(!btnAnterior) return;\r\n    \r\n    btnAnterior.addEventListener('click', () => {\r\n        if(paso <= pasoInicial) return;\r\n        \r\n        paso--;\r\n        mostrarSeccion();\r\n        botonesPaginador();\r\n    });\r\n}\r\n\r\nfunction botonesPaginador() {\r\n    const btnAnterior = document.querySelector('#anterior');\r\n    const btnSiguiente = document.querySelector('#siguiente');\r\n    \r\n    if(!btnAnterior || !btnSiguiente) return;\r\n\r\n    if(paso === 1) {\r\n        btnAnterior.classList.add('opacity-50');\r\n        btnAnterior.disabled = true;\r\n    } else {\r\n        btnAnterior.classList.remove('opacity-50');\r\n        btnAnterior.disabled = false;\r\n    }\r\n\r\n    if(paso === 4) {\r\n        btnSiguiente.classList.add('opacity-50');\r\n        btnSiguiente.textContent = 'Confirmar';\r\n        btnSiguiente.disabled = true;\r\n    } else {\r\n        btnSiguiente.classList.remove('opacity-50');\r\n        btnSiguiente.disabled = false;\r\n        btnSiguiente.textContent = 'Siguiente »';\r\n    }\r\n}\r\n\r\nfunction mostrarSeccion() {\r\n    // Ocultar la sección que tenga la clase de mostrar\r\n    const seccionAnterior = document.querySelector('.seccion:not(.hidden)');\r\n    if(seccionAnterior) {\r\n        seccionAnterior.classList.add('hidden');\r\n    }\r\n    \r\n    // Seleccionar la sección con el paso\r\n    const pasoSelector = `#paso-${paso}`;\r\n    const seccion = document.querySelector(pasoSelector);\r\n    if(seccion) {\r\n        seccion.classList.remove('hidden');\r\n    }\r\n    \r\n    // Quita la clase \"actual\" al tab anterior\r\n    const tabAnterior = document.querySelector('.step-button.bg-blue-500');\r\n    if(tabAnterior) {\r\n        tabAnterior.classList.remove('bg-blue-500', 'text-white');\r\n        tabAnterior.classList.add('bg-gray-300', 'text-gray-600');\r\n    }\r\n    \r\n    // Resalta el tab actual\r\n    const tab = document.querySelector(`[data-paso=\"${paso}\"]`);\r\n    if(tab) {\r\n        tab.classList.remove('bg-gray-300', 'text-gray-600');\r\n        tab.classList.add('bg-blue-500', 'text-white');\r\n    }\r\n    \r\n    // Actualizar la barra de progreso\r\n    const progreso = document.querySelector('#progress');\r\n    if(progreso) {\r\n        progreso.style.width = `${(paso / pasoFinal) * 100}%`;\r\n    }\r\n}\r\n\r\nfunction mostrarAlerta(mensaje, tipo) {\r\n    if(typeof Swal === 'undefined') {\r\n        console.error('SweetAlert2 no está cargado');\r\n        alert(mensaje);\r\n        return;\r\n    }\r\n\r\n    Swal.fire({\r\n        icon: tipo,\r\n        title: tipo === 'error' ? 'Error' : 'Éxito',\r\n        text: mensaje\r\n    });\r\n}\r\n\r\nfunction tabs() {\r\n    const botones = document.querySelectorAll('.step-button');\r\n    botones.forEach(boton => {\r\n        boton.addEventListener('click', function(e) {\r\n            paso = parseInt(e.target.dataset.paso);\r\n            mostrarSeccion();\r\n            botonesPaginador();\r\n        });\r\n    });\r\n}\r\n\r\nfunction validarServicios() {\r\n    if(cita.servicios.length === 0) {\r\n        mostrarAlerta('Debes seleccionar al menos un servicio', 'error');\r\n        return false;\r\n    }\r\n    return true;\r\n}\r\n\r\nfunction validarFecha() {\r\n    const fecha = document.querySelector('#fecha').value;\r\n    const hora = document.querySelector('#hora').value;\r\n    \r\n    if(fecha === '' || hora === '') {\r\n        mostrarAlerta('Debes seleccionar fecha y hora', 'error');\r\n        return false;\r\n    }\r\n    \r\n    return true;\r\n}\r\n\r\nfunction validarResumen() {\r\n    const elementos = Object.values(cita);\r\n    if(elementos.includes('')) {\r\n        mostrarAlerta('Faltan datos por confirmar', 'error');\r\n        return false;\r\n    }\r\n    return true;\r\n}\r\n\r\nfunction seleccionarServicio(servicio) {\r\n    const { id } = servicio;\r\n    const { servicios } = cita;\r\n\r\n    // Identificar el elemento clickeado\r\n    const divServicio = document.querySelector(`[data-id-servicio=\"${id}\"]`);\r\n\r\n    // Comprobar si un servicio ya fue agregado o quitarlo\r\n    if(servicios.some(agregado => agregado.id === id)) {\r\n        // Eliminarlo\r\n        cita.servicios = servicios.filter(agregado => agregado.id !== id);\r\n        divServicio.classList.remove('seleccionado');\r\n    } else {\r\n        // Agregarlo\r\n        cita.servicios = [...servicios, servicio];\r\n        divServicio.classList.add('seleccionado');\r\n    }\r\n}\r\n\r\n// También necesitamos implementar las funciones de cliente\r\nfunction idCliente() {\r\n    const id = document.querySelector('#id').value;\r\n    cita.id = id;\r\n}\r\n\r\nfunction nombreCliente() {\r\n    const nombre = document.querySelector('#nombre').value;\r\n    cita.nombre = nombre;\r\n}\r\n\r\nfunction seleccionarFecha() {\r\n    const inputFecha = document.querySelector('#fecha');\r\n    inputFecha.addEventListener('input', function(e) {\r\n        const dia = new Date(e.target.value).getUTCDay();\r\n        \r\n        if([6, 0].includes(dia)) {\r\n            e.target.value = '';\r\n            mostrarAlerta('Fines de semana no permitidos', 'error');\r\n        } else {\r\n            cita.fecha = e.target.value;\r\n        }\r\n    });\r\n}\r\n\r\nfunction seleccionarHora() {\r\n    const inputHora = document.querySelector('#hora');\r\n    inputHora.addEventListener('input', function(e) {\r\n        const horaCita = e.target.value;\r\n        const hora = horaCita.split(\":\")[0];\r\n        if(hora < 10 || hora > 18) {\r\n            e.target.value = '';\r\n            mostrarAlerta('Hora no válida', 'error');\r\n        } else {\r\n            cita.hora = e.target.value;\r\n        }\r\n    });\r\n}\r\n\r\nfunction mostrarResumen() {\r\n    const resumen = document.querySelector('#resumen-cita');\r\n\r\n    // Limpiar el contenido\r\n    while(resumen.firstChild) {\r\n        resumen.removeChild(resumen.firstChild);\r\n    }\r\n\r\n    if(Object.values(cita).includes('') || cita.servicios.length === 0) {\r\n        return;\r\n    }\r\n\r\n    const { nombre, fecha, hora, servicios } = cita;\r\n\r\n    // Heading para Servicios\r\n    const headingServicios = document.createElement('H3');\r\n    headingServicios.textContent = 'Resumen de Servicios';\r\n    resumen.appendChild(headingServicios);\r\n\r\n    // Iterando y mostrando los servicios\r\n    servicios.forEach(servicio => {\r\n        const { nombre, precio } = servicio;\r\n        const contenedorServicio = document.createElement('DIV');\r\n        contenedorServicio.classList.add('contenedor-servicio');\r\n\r\n        const textoServicio = document.createElement('P');\r\n        textoServicio.textContent = nombre;\r\n\r\n        const precioServicio = document.createElement('P');\r\n        precioServicio.innerHTML = `<span>Precio:</span> $${precio}`;\r\n\r\n        contenedorServicio.appendChild(textoServicio);\r\n        contenedorServicio.appendChild(precioServicio);\r\n\r\n        resumen.appendChild(contenedorServicio);\r\n    });\r\n\r\n    // Heading para Cita\r\n    const headingCita = document.createElement('H3');\r\n    headingCita.textContent = 'Resumen de Cita';\r\n    resumen.appendChild(headingCita);\r\n\r\n    const nombreCliente = document.createElement('P');\r\n    nombreCliente.innerHTML = `<span>Nombre:</span> ${nombre}`;\r\n\r\n    const fechaFormateada = new Date(fecha).toLocaleDateString('es-ES', {\r\n        weekday: 'long',\r\n        year: 'numeric',\r\n        month: 'long',\r\n        day: 'numeric'\r\n    });\r\n    const fechaCita = document.createElement('P');\r\n    fechaCita.innerHTML = `<span>Fecha:</span> ${fechaFormateada}`;\r\n\r\n    const horaCita = document.createElement('P');\r\n    horaCita.innerHTML = `<span>Hora:</span> ${hora} Horas`;\r\n\r\n    resumen.appendChild(nombreCliente);\r\n    resumen.appendChild(fechaCita);\r\n    resumen.appendChild(horaCita);\r\n}\r\n\r\n// ... Resto de las funciones existentes ..."]}