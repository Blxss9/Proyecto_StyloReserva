{"version":3,"sources":["app.js"],"names":["paso","pasoInicial","pasoFinal","cita","id","nombre","fecha","hora","servicios","iniciarApp","mostrarSeccion","tabs","botonesPaginador","paginaSiguiente","paginaAnterior","consultarAPI","idCliente","nombreCliente","seleccionarFecha","seleccionarHora","mostrarResumen","async","url","respuesta","fetch","resultado","json","error","console","mostrarAlerta","mostrarServicios","contenedorServicios","document","querySelector","innerHTML","forEach","servicio","nombre_servicio","precio","tiempo_estimado","precioFormateado","parseInt","toLocaleString","tiempoFormateado","formatearTiempo","servicioDiv","createElement","classList","add","dataset","idServicio","onclick","seleccionarServicio","appendChild","btnSiguiente","addEventListener","validarServicios","validarFecha","btnAnterior","remove","textContent","disabled","seccionAnterior","pasoSelector","seccion","tabAnterior","tab","progreso","style","width","mensaje","tipo","Swal","alert","fire","icon","title","text","querySelectorAll","boton","e","pasoSeleccionado","target","length","value","validarResumen","Object","values","includes","divServicio","some","agregado","filter","inputId","inputNombre","inputFecha","horasDisponibles","hoy","Date","fechaMinima","getFullYear","getMonth","toString","padStart","getDate","min","fechaSeleccionada","dia","getUTCDay","mostrarHorasDisponibles","horas","mañana","tarde","noche","periodo","contenedor","type","btn","this","split","minutos","Math","floor","minutosRestantes","resumen","firstChild","removeChild","contenedorResumen","tituloServicios","servicioParrafo","Intl","NumberFormat","currency","format","tiempoTotal","reduce","total","tiempoParrafo","tiempoTotalFormateado","fechaFormateada","toLocaleDateString","weekday","year","month","day","fechaCapitalizada","charAt","toUpperCase","slice","fechaCita","horaCita","parseFloat","totalFormateado","totalParrafo"],"mappings":"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","file":"app.js","sourcesContent":["let paso = 1;\r\nconst pasoInicial = 1;\r\nconst pasoFinal = 4;\r\n\r\nconst cita = {\r\n    id: '',\r\n    nombre: '',\r\n    fecha: '',\r\n    hora: '',\r\n    servicios: []\r\n}\r\n\r\ndocument.addEventListener('DOMContentLoaded', function() {\r\n    iniciarApp();\r\n});\r\n\r\nfunction iniciarApp() {\r\n    mostrarSeccion(); // Muestra y oculta las secciones\r\n    tabs(); // Cambia la sección cuando se presionen los tabs\r\n    botonesPaginador(); // Agrega o quita los botones del paginador\r\n    paginaSiguiente();\r\n    paginaAnterior();\r\n    \r\n    consultarAPI(); // Consulta la API en el backend de PHP\r\n    \r\n    idCliente(); // Añade el id del cliente al objeto de cita\r\n    nombreCliente(); // Añade el nombre del cliente al objeto de cita\r\n    seleccionarFecha(); // Añade la fecha de la cita en el objeto\r\n    seleccionarHora(); // Añade la hora de la cita en el objeto\r\n    \r\n    mostrarResumen(); // Muestra el resumen de la cita\r\n}\r\n\r\nasync function consultarAPI() {\r\n    try {\r\n        const url = '/api/servicios';\r\n        const respuesta = await fetch(url);\r\n        const resultado = await respuesta.json();\r\n        \r\n        if(!resultado.error) {\r\n            mostrarServicios(resultado);\r\n        } else {\r\n            console.error(resultado.error);\r\n            mostrarAlerta('Error al cargar los servicios', 'error');\r\n        }\r\n        \r\n    } catch (error) {\r\n        console.error(error);\r\n        mostrarAlerta('Error al cargar los servicios', 'error');\r\n    }\r\n}\r\n\r\nfunction mostrarServicios(servicios) {\r\n    const contenedorServicios = document.querySelector('#servicios');\r\n    \r\n    if(!contenedorServicios) {\r\n        console.error('El contenedor de servicios no existe');\r\n        return;\r\n    }\r\n    \r\n    // Limpiar el HTML previo\r\n    contenedorServicios.innerHTML = '';\r\n    \r\n    servicios.forEach(servicio => {\r\n        const { id, nombre_servicio, precio, tiempo_estimado } = servicio;\r\n        const precioFormateado = parseInt(precio).toLocaleString('es-CL');\r\n        const tiempoFormateado = formatearTiempo(parseInt(tiempo_estimado));\r\n\r\n        const servicioDiv = document.createElement('DIV');\r\n        servicioDiv.classList.add('servicio');\r\n        servicioDiv.dataset.idServicio = id;\r\n\r\n        servicioDiv.innerHTML = `\r\n            <p class=\"nombre-servicio\">${nombre_servicio}</p>\r\n            <p class=\"precio-servicio\">$${precioFormateado}</p>\r\n            <p class=\"tiempo-servicio\">Duración: ${tiempoFormateado}</p>\r\n        `;\r\n\r\n        servicioDiv.onclick = () => seleccionarServicio(servicio);\r\n        contenedorServicios.appendChild(servicioDiv);\r\n    });\r\n}\r\n\r\nfunction paginaSiguiente() {\r\n    const btnSiguiente = document.querySelector('#siguiente');\r\n    \r\n    if(!btnSiguiente) return;\r\n    \r\n    btnSiguiente.addEventListener('click', () => {\r\n        if(paso >= pasoFinal) return;\r\n        \r\n        if(paso === 1) {\r\n            // Validar que se haya seleccionado al menos un servicio\r\n            if(!validarServicios()) return;\r\n        }\r\n        \r\n        if(paso === 2) {\r\n            // Validar que se haya seleccionado fecha y hora\r\n            if(!validarFecha()) return;\r\n        }\r\n        \r\n        paso++;\r\n        mostrarSeccion();\r\n        botonesPaginador();\r\n        \r\n        // Actualizar el resumen al cambiar de página\r\n        mostrarResumen();\r\n    });\r\n}\r\n\r\nfunction paginaAnterior() {\r\n    const btnAnterior = document.querySelector('#anterior');\r\n    \r\n    if(!btnAnterior) return;\r\n    \r\n    btnAnterior.addEventListener('click', () => {\r\n        if(paso <= pasoInicial) return;\r\n        \r\n        paso--;\r\n        mostrarSeccion();\r\n        botonesPaginador();\r\n    });\r\n}\r\n\r\nfunction botonesPaginador() {\r\n    const btnAnterior = document.querySelector('#anterior');\r\n    const btnSiguiente = document.querySelector('#siguiente');\r\n    \r\n    if(!btnAnterior || !btnSiguiente) return;\r\n\r\n    if(paso === 1) {\r\n        btnAnterior.classList.add('hidden');\r\n    } else {\r\n        btnAnterior.classList.remove('hidden');\r\n    }\r\n\r\n    if(paso === 4) {\r\n        btnSiguiente.classList.add('opacity-50');\r\n        btnSiguiente.textContent = 'Confirmar';\r\n        btnSiguiente.disabled = true;\r\n    } else {\r\n        btnSiguiente.classList.remove('opacity-50');\r\n        btnSiguiente.disabled = false;\r\n        btnSiguiente.textContent = 'Siguiente »';\r\n    }\r\n}\r\n\r\nfunction mostrarSeccion() {\r\n    // Ocultar la sección que tenga la clase de mostrar\r\n    const seccionAnterior = document.querySelector('.seccion:not(.hidden)');\r\n    if(seccionAnterior) {\r\n        seccionAnterior.classList.add('hidden');\r\n    }\r\n    \r\n    // Seleccionar la sección con el paso\r\n    const pasoSelector = `#paso-${paso}`;\r\n    const seccion = document.querySelector(pasoSelector);\r\n    if(seccion) {\r\n        seccion.classList.remove('hidden');\r\n    }\r\n    \r\n    // Quita la clase \"actual\" al tab anterior\r\n    const tabAnterior = document.querySelector('.step-button.bg-blue-500');\r\n    if(tabAnterior) {\r\n        tabAnterior.classList.remove('bg-blue-500', 'text-white');\r\n        tabAnterior.classList.add('bg-gray-300', 'text-gray-600');\r\n    }\r\n    \r\n    // Resalta el tab actual\r\n    const tab = document.querySelector(`[data-paso=\"${paso}\"]`);\r\n    if(tab) {\r\n        tab.classList.remove('bg-gray-300', 'text-gray-600');\r\n        tab.classList.add('bg-blue-500', 'text-white');\r\n    }\r\n    \r\n    // Actualizar la barra de progreso\r\n    const progreso = document.querySelector('#progress');\r\n    if(progreso) {\r\n        progreso.style.width = `${(paso / pasoFinal) * 100}%`;\r\n    }\r\n}\r\n\r\nfunction mostrarAlerta(mensaje, tipo) {\r\n    if(typeof Swal === 'undefined') {\r\n        console.error('SweetAlert2 no está cargado');\r\n        alert(mensaje);\r\n        return;\r\n    }\r\n\r\n    Swal.fire({\r\n        icon: tipo,\r\n        title: tipo === 'error' ? 'Error' : 'Éxito',\r\n        text: mensaje\r\n    });\r\n}\r\n\r\nfunction tabs() {\r\n    const botones = document.querySelectorAll('.step-button');\r\n    botones.forEach(boton => {\r\n        boton.addEventListener('click', function(e) {\r\n            const pasoSeleccionado = parseInt(e.target.dataset.paso);\r\n            \r\n            // Si intenta retroceder, permitirlo\r\n            if (pasoSeleccionado < paso) {\r\n                paso = pasoSeleccionado;\r\n                mostrarSeccion();\r\n                botonesPaginador();\r\n                return;\r\n            }\r\n\r\n            // Validaciones para avanzar\r\n            if (paso === 1 && !validarServicios()) {\r\n                return;\r\n            }\r\n\r\n            if (paso === 2 && !validarFecha()) {\r\n                return;\r\n            }\r\n\r\n            // Si todas las validaciones pasan, permitir el cambio\r\n            if (pasoSeleccionado - paso === 1) {\r\n                paso = pasoSeleccionado;\r\n                mostrarSeccion();\r\n                botonesPaginador();\r\n            } else {\r\n                // Si intenta saltar más de una sección, mostrar alerta\r\n                mostrarAlerta('Por favor, complete los pasos en orden', 'error');\r\n            }\r\n        });\r\n    });\r\n}\r\n\r\nfunction validarServicios() {\r\n    if(cita.servicios.length === 0) {\r\n        mostrarAlerta('Debes seleccionar al menos un servicio', 'error');\r\n        return false;\r\n    }\r\n    return true;\r\n}\r\n\r\nfunction validarFecha() {\r\n    const fecha = document.querySelector('#fecha').value;\r\n    \r\n    if(fecha === '' || !cita.hora) {\r\n        mostrarAlerta('Debes seleccionar fecha y hora', 'error');\r\n        return false;\r\n    }\r\n    \r\n    return true;\r\n}\r\n\r\nfunction validarResumen() {\r\n    const elementos = Object.values(cita);\r\n    if(elementos.includes('')) {\r\n        mostrarAlerta('Faltan datos por confirmar', 'error');\r\n        return false;\r\n    }\r\n    return true;\r\n}\r\n\r\nfunction seleccionarServicio(servicio) {\r\n    const { id } = servicio;\r\n    const { servicios } = cita;\r\n\r\n    // Identificar el elemento clickeado\r\n    const divServicio = document.querySelector(`[data-id-servicio=\"${id}\"]`);\r\n\r\n    // Comprobar si un servicio ya fue agregado o quitarlo\r\n    if(servicios.some(agregado => agregado.id === id)) {\r\n        // Eliminarlo\r\n        cita.servicios = servicios.filter(agregado => agregado.id !== id);\r\n        divServicio.classList.remove('seleccionado');\r\n    } else {\r\n        // Agregarlo\r\n        cita.servicios = [...servicios, servicio];\r\n        divServicio.classList.add('seleccionado');\r\n    }\r\n    \r\n    // Actualizar el resumen cada vez que se selecciona o deselecciona un servicio\r\n    mostrarResumen();\r\n}\r\n\r\n// También necesitamos implementar las funciones de cliente\r\nfunction idCliente() {\r\n    // Verificar si el elemento existe antes de acceder a su valor\r\n    const inputId = document.querySelector('#id');\r\n    if(inputId) {\r\n        cita.id = inputId.value;\r\n    }\r\n}\r\n\r\nfunction nombreCliente() {\r\n    // Verificar si el elemento existe antes de acceder a su valor\r\n    const inputNombre = document.querySelector('#nombre');\r\n    if(inputNombre) {\r\n        cita.nombre = inputNombre.value;\r\n    }\r\n}\r\n\r\nfunction seleccionarFecha() {\r\n    const inputFecha = document.querySelector('#fecha');\r\n    const horasDisponibles = document.querySelector('#horas-disponibles');\r\n    \r\n    if(!inputFecha || !horasDisponibles) {\r\n        console.error('No se encontraron los elementos necesarios');\r\n        return;\r\n    }\r\n    \r\n    // Establecer la fecha mínima como hoy\r\n    const hoy = new Date();\r\n    const año = hoy.getFullYear();\r\n    const mes = (hoy.getMonth() + 1).toString().padStart(2, '0');\r\n    const dia = hoy.getDate().toString().padStart(2, '0');\r\n    const fechaMinima = `${año}-${mes}-${dia}`;\r\n    \r\n    inputFecha.min = fechaMinima;\r\n    \r\n    inputFecha.addEventListener('input', function(e) {\r\n        const fechaSeleccionada = new Date(e.target.value + 'T00:00:00');\r\n        const fechaHoy = new Date(fechaMinima + 'T00:00:00');\r\n        \r\n        if(fechaSeleccionada < fechaHoy) {\r\n            e.target.value = '';\r\n            mostrarAlerta('No puedes seleccionar fechas pasadas', 'error');\r\n            horasDisponibles.classList.add('hidden');\r\n            cita.fecha = '';\r\n            cita.hora = '';\r\n        } else {\r\n            const dia = fechaSeleccionada.getUTCDay();\r\n            \r\n            if([6, 0].includes(dia)) {\r\n                e.target.value = '';\r\n                mostrarAlerta('Fines de semana no permitidos', 'error');\r\n                horasDisponibles.classList.add('hidden');\r\n                cita.fecha = '';\r\n                cita.hora = '';\r\n            } else {\r\n                cita.fecha = e.target.value;\r\n                mostrarHorasDisponibles();\r\n            }\r\n        }\r\n        // Actualizar el resumen cuando se selecciona una fecha\r\n        mostrarResumen();\r\n    });\r\n}\r\n\r\nfunction mostrarHorasDisponibles() {\r\n    const horasDisponibles = document.querySelector('#horas-disponibles');\r\n    \r\n    if(!horasDisponibles) {\r\n        console.error('No se encontró el contenedor de horas disponibles');\r\n        return;\r\n    }\r\n    \r\n    horasDisponibles.classList.remove('hidden');\r\n\r\n    // Definir las horas disponibles por período\r\n    const horas = {\r\n        mañana: ['10:00', '10:50', '11:40'],\r\n        tarde: ['12:30', '15:00', '15:50', '16:40', '17:30'],\r\n        noche: ['18:20', '19:10']\r\n    };\r\n\r\n    // Limpiar contenedores\r\n    ['mañana', 'tarde', 'noche'].forEach(periodo => {\r\n        const contenedor = document.querySelector(`#horas-${periodo}`);\r\n        if(!contenedor) {\r\n            console.error(`No se encontró el contenedor para ${periodo}`);\r\n            return;\r\n        }\r\n        \r\n        contenedor.innerHTML = '';\r\n        \r\n        horas[periodo].forEach(hora => {\r\n            const boton = document.createElement('BUTTON');\r\n            boton.type = 'button';\r\n            boton.classList.add('px-4', 'py-2', 'text-sm', 'border', 'rounded', 'hover:bg-blue-500', 'hover:text-white');\r\n            \r\n            if(cita.hora === hora) {\r\n                boton.classList.add('bg-blue-500', 'text-white');\r\n            }\r\n            \r\n            boton.textContent = hora;\r\n            \r\n            boton.onclick = function() {\r\n                document.querySelectorAll('button[type=\"button\"]').forEach(btn => {\r\n                    btn.classList.remove('bg-blue-500', 'text-white');\r\n                });\r\n                \r\n                this.classList.add('bg-blue-500', 'text-white');\r\n                cita.hora = hora;\r\n                \r\n                // Actualizar el resumen cuando se selecciona una hora\r\n                mostrarResumen();\r\n            };\r\n            \r\n            contenedor.appendChild(boton);\r\n        });\r\n    });\r\n}\r\n\r\nfunction seleccionarHora() {\r\n    const inputHora = document.querySelector('#hora');\r\n    inputHora.addEventListener('input', function(e) {\r\n        const horaCita = e.target.value;\r\n        const hora = horaCita.split(\":\")[0];\r\n        if(hora < 10 || hora > 18) {\r\n            e.target.value = '';\r\n            mostrarAlerta('Hora no válida', 'error');\r\n        } else {\r\n            cita.hora = e.target.value;\r\n        }\r\n    });\r\n}\r\n\r\nfunction formatearTiempo(minutos) {\r\n    if (minutos >= 60) {\r\n        const horas = Math.floor(minutos / 60);\r\n        const minutosRestantes = minutos % 60;\r\n        \r\n        if (minutosRestantes === 0) {\r\n            return `${horas} ${horas === 1 ? 'hora' : 'horas'}`;\r\n        } else {\r\n            return `${horas} ${horas === 1 ? 'hora' : 'horas'} y ${minutosRestantes} ${minutosRestantes === 1 ? 'minuto' : 'minutos'}`;\r\n        }\r\n    }\r\n    return `${minutos} ${minutos === 1 ? 'minuto' : 'minutos'}`;\r\n}\r\n\r\nfunction mostrarResumen() {\r\n    const resumen = document.querySelector('#resumen-cita');\r\n\r\n    // Limpiar el contenido\r\n    while(resumen.firstChild) {\r\n        resumen.removeChild(resumen.firstChild);\r\n    }\r\n\r\n    // Verificar si hay servicios seleccionados y datos completos\r\n    if(Object.values(cita).includes('') || cita.servicios.length === 0) {\r\n        return;\r\n    }\r\n\r\n    const { nombre, fecha, hora, servicios } = cita;\r\n\r\n    // Contenedor principal\r\n    const contenedorResumen = document.createElement('DIV');\r\n    contenedorResumen.classList.add('p-6', 'space-y-6');\r\n\r\n    // Nombre del cliente\r\n    const nombreCliente = document.createElement('P');\r\n    nombreCliente.innerHTML = `<span class=\"font-bold\">Nombre:</span> ${nombre}`;\r\n    nombreCliente.classList.add('text-lg');\r\n\r\n    // Contenedor de servicios\r\n    const contenedorServicios = document.createElement('DIV');\r\n    contenedorServicios.classList.add('space-y-3');\r\n\r\n    // Título de servicios\r\n    const tituloServicios = document.createElement('H3');\r\n    tituloServicios.textContent = 'Servicios Seleccionados:';\r\n    tituloServicios.classList.add('font-bold', 'text-lg', 'mb-3');\r\n    contenedorServicios.appendChild(tituloServicios);\r\n\r\n    // Iterando y mostrando los servicios\r\n    servicios.forEach(servicio => {\r\n        const { nombre_servicio, precio, tiempo_estimado } = servicio;\r\n        const servicioParrafo = document.createElement('P');\r\n        const precioFormateado = new Intl.NumberFormat('es-CL', {\r\n            style: 'currency',\r\n            currency: 'CLP'\r\n        }).format(precio);\r\n        const tiempoFormateado = formatearTiempo(parseInt(tiempo_estimado));\r\n        servicioParrafo.textContent = `${nombre_servicio} - ${tiempoFormateado} - ${precioFormateado}`;\r\n        contenedorServicios.appendChild(servicioParrafo);\r\n    });\r\n\r\n    // Calcular y mostrar el tiempo total\r\n    const tiempoTotal = servicios.reduce((total, servicio) => total + parseInt(servicio.tiempo_estimado), 0);\r\n    const tiempoParrafo = document.createElement('P');\r\n    const tiempoTotalFormateado = formatearTiempo(tiempoTotal);\r\n    tiempoParrafo.innerHTML = `<span class=\"font-bold\">Tiempo Total:</span> ${tiempoTotalFormateado}`;\r\n    tiempoParrafo.classList.add('text-lg', 'mt-3');\r\n\r\n    // Formatear la fecha\r\n    const fechaObj = new Date(fecha);\r\n    const opciones = { \r\n        weekday: 'long', \r\n        year: 'numeric', \r\n        month: 'long', \r\n        day: 'numeric'\r\n    };\r\n    const fechaFormateada = fechaObj.toLocaleDateString('es-CL', opciones);\r\n    // Capitalizar primera letra\r\n    const fechaCapitalizada = fechaFormateada.charAt(0).toUpperCase() + fechaFormateada.slice(1);\r\n\r\n    const fechaCita = document.createElement('P');\r\n    fechaCita.innerHTML = `<span class=\"font-bold\">Fecha:</span> ${fechaCapitalizada}`;\r\n    fechaCita.classList.add('text-lg');\r\n\r\n    const horaCita = document.createElement('P');\r\n    horaCita.innerHTML = `<span class=\"font-bold\">Hora:</span> ${hora} hrs`;\r\n    horaCita.classList.add('text-lg');\r\n\r\n    // Calcular y mostrar el total\r\n    const total = servicios.reduce((total, servicio) => total + parseFloat(servicio.precio), 0);\r\n    const totalFormateado = new Intl.NumberFormat('es-CL', {\r\n        style: 'currency',\r\n        currency: 'CLP'\r\n    }).format(total);\r\n    \r\n    const totalParrafo = document.createElement('P');\r\n    totalParrafo.innerHTML = `<span class=\"font-bold\">Total:</span> ${totalFormateado}`;\r\n    totalParrafo.classList.add('text-xl', 'mt-6');\r\n\r\n    // Agregar al contenedor principal\r\n    contenedorResumen.appendChild(nombreCliente);\r\n    contenedorResumen.appendChild(contenedorServicios);\r\n    contenedorResumen.appendChild(fechaCita);\r\n    contenedorResumen.appendChild(horaCita);\r\n    contenedorResumen.appendChild(tiempoParrafo);\r\n    contenedorResumen.appendChild(totalParrafo);\r\n\r\n    // Agregar al resumen\r\n    resumen.appendChild(contenedorResumen);\r\n}\r\n\r\n// ... Resto de las funciones existentes ..."]}